
CREATE TABLE gtfs_feed_stats (table_name text, column_name text, active_field int);

INSERT INTO gtfs_feed_stats (table_name, column_name, active_field) VALUES 
('DBNAME',(SELECT table_catalog FROM information_schema.columns LIMIT 1)::text,0),
('agency', 'agency_id', (SELECT COUNT(agency_id) FROM gtfs_agency)),
('agency', 'agency_name', (SELECT COUNT(agency_name) FROM gtfs_agency)),
('agency', 'agency_url', (SELECT COUNT(agency_url) FROM gtfs_agency)),
('agency', 'agency_timezone', (SELECT COUNT(agency_timezone) FROM gtfs_agency)),
('agency', 'agency_lang', (SELECT COUNT(agency_lang) FROM gtfs_agency)),
('agency', 'agency_phone', (SELECT COUNT(agency_phone) FROM gtfs_agency)),
('agency', 'agency_fare_url', (SELECT COUNT(agency_fare_url) FROM gtfs_agency)),
('stops', 'stop_id', (SELECT COUNT(stop_id) FROM gtfs_stops)),
('stops', 'stop_code', (SELECT COUNT(stop_code) FROM gtfs_stops)),
('stops', 'stop_name', (SELECT COUNT(stop_name) FROM gtfs_stops)),
('stops', 'stop_desc', (SELECT COUNT(stop_desc) FROM gtfs_stops)),
('stops', 'stop_lat', (SELECT COUNT(stop_lat) FROM gtfs_stops)),
('stops', 'stop_lon', (SELECT COUNT(stop_lon) FROM gtfs_stops)),
('stops', 'zone_id', (SELECT COUNT(zone_id) FROM gtfs_stops)),
('stops', 'stop_url', (SELECT COUNT(stop_url) FROM gtfs_stops)),
('stops', 'location_type', (SELECT COUNT(location_type) FROM gtfs_stops)),
('stops', 'parent_station', (SELECT COUNT(parent_station) FROM gtfs_stops)),
('stops', 'stop_timezone', (SELECT COUNT(stop_timezone) FROM gtfs_stops)),
('stops', 'wheelchair_boarding', (SELECT COUNT(wheelchair_boarding) FROM gtfs_stops)),
('routes', 'route_id', (SELECT COUNT(route_id) FROM gtfs_routes)),
('routes', 'agency_id', (SELECT COUNT(agency_id) FROM gtfs_routes)),
('routes', 'route_short_name', (SELECT COUNT(route_short_name) FROM gtfs_routes)),
('routes', 'route_long_name', (SELECT COUNT(route_long_name) FROM gtfs_routes)),
('routes', 'route_desc', (SELECT COUNT(route_desc) FROM gtfs_routes)),
('routes', 'route_type', (SELECT COUNT(route_type) FROM gtfs_routes)),
('routes', 'route_url', (SELECT COUNT(route_url) FROM gtfs_routes)),
('routes', 'route_color', (SELECT COUNT(route_color) FROM gtfs_routes)),
('routes', 'route_text_color', (SELECT COUNT(route_text_color) FROM gtfs_routes)),
('trips', 'route_id', (SELECT COUNT(route_id) FROM gtfs_trips)),
('trips', 'service_id', (SELECT COUNT(service_id) FROM gtfs_trips)),
('trips', 'trip_id', (SELECT COUNT(trip_id) FROM gtfs_trips)),
('trips', 'trip_headsign', (SELECT COUNT(trip_headsign) FROM gtfs_trips)),
('trips', 'trip_short_name', (SELECT COUNT(trip_short_name) FROM gtfs_trips)),
('trips', 'direction_id', (SELECT COUNT(direction_id) FROM gtfs_trips)),
('trips', 'block_id', (SELECT COUNT(block_id) FROM gtfs_trips)),
('trips', 'shape_id', (SELECT COUNT(shape_id) FROM gtfs_trips)),
('stop_times', 'trip_id', (SELECT COUNT(trip_id) FROM gtfs_stop_times)),
('stop_times', 'arrival_time', (SELECT COUNT(arrival_time) FROM gtfs_stop_times)),
('stop_times', 'departure_time', (SELECT COUNT(departure_time) FROM gtfs_stop_times)),
('stop_times', 'stop_id', (SELECT COUNT(stop_id) FROM gtfs_stop_times)),
('stop_times', 'stop_sequence', (SELECT COUNT(stop_sequence) FROM gtfs_stop_times)),
('stop_times', 'stop_headsign', (SELECT COUNT(stop_headsign) FROM gtfs_stop_times)),
('stop_times', 'pickup_type', (SELECT COUNT(pickup_type) FROM gtfs_stop_times)),
('stop_times', 'drop_off_type', (SELECT COUNT(drop_off_type) FROM gtfs_stop_times)),
('stop_times', 'shape_dist_traveled', (SELECT COUNT(shape_dist_traveled) FROM gtfs_stop_times)),
('calendar', 'service_id', (SELECT COUNT(service_id) FROM gtfs_calendar)),
('calendar', 'monday', (SELECT COUNT(monday) FROM gtfs_calendar)),
('calendar', 'tuesday', (SELECT COUNT(tuesday) FROM gtfs_calendar)),
('calendar', 'wednesday', (SELECT COUNT(wednesday) FROM gtfs_calendar)),
('calendar', 'thursday', (SELECT COUNT(thursday) FROM gtfs_calendar)),
('calendar', 'friday', (SELECT COUNT(friday) FROM gtfs_calendar)),
('calendar', 'saturday', (SELECT COUNT(saturday) FROM gtfs_calendar)),
('calendar', 'sunday', (SELECT COUNT(sunday) FROM gtfs_calendar)),
('calendar', 'start_date', (SELECT COUNT(start_date) FROM gtfs_calendar)),
('calendar', 'end_date', (SELECT COUNT(end_date) FROM gtfs_calendar)),
('calendar_dates', 'service_id', (SELECT COUNT(service_id) FROM gtfs_calendar_dates)),
('calendar_dates', 'date', (SELECT COUNT(date) FROM gtfs_calendar_dates)),
('calendar_dates', 'exception_type', (SELECT COUNT(exception_type) FROM gtfs_calendar_dates)),
('fare_attributes', 'fare_id', (SELECT COUNT(fare_id) FROM gtfs_fare_attributes)),
('fare_attributes', 'price', (SELECT COUNT(price) FROM gtfs_fare_attributes)),
('fare_attributes', 'currency_type', (SELECT COUNT(currency_type) FROM gtfs_fare_attributes)),
('fare_attributes', 'payment_method', (SELECT COUNT(payment_method) FROM gtfs_fare_attributes)),
('fare_attributes', 'transfers', (SELECT COUNT(transfers) FROM gtfs_fare_attributes)),
('fare_attributes', 'transfer_duration', (SELECT COUNT(transfer_duration) FROM gtfs_fare_attributes)),
('fare_rules', 'fare_id', (SELECT COUNT(fare_id) FROM gtfs_fare_rules)),
('fare_rules', 'route_id', (SELECT COUNT(route_id) FROM gtfs_fare_rules)),
('fare_rules', 'origin_id', (SELECT COUNT(origin_id) FROM gtfs_fare_rules)),
('fare_rules', 'destination_id', (SELECT COUNT(destination_id) FROM gtfs_fare_rules)),
('fare_rules', 'contains_id', (SELECT COUNT(contains_id) FROM gtfs_fare_rules)),
('shapes', 'shape_id', (SELECT COUNT(shape_id) FROM gtfs_shapes)),
('shapes', 'shape_pt_lat', (SELECT COUNT(shape_pt_lat) FROM gtfs_shapes)),
('shapes', 'shape_pt_lon', (SELECT COUNT(shape_pt_lon) FROM gtfs_shapes)),
('shapes', 'shape_pt_sequence', (SELECT COUNT(shape_pt_sequence) FROM gtfs_shapes)),
('shapes', 'shape_dist_traveled', (SELECT COUNT(shape_dist_traveled) FROM gtfs_shapes)),
('frequencies', 'trip_id', (SELECT COUNT(trip_id) FROM gtfs_frequencies)),
('frequencies', 'start_time', (SELECT COUNT(start_time) FROM gtfs_frequencies)),
('frequencies', 'end_time', (SELECT COUNT(end_time) FROM gtfs_frequencies)),
('frequencies', 'headway_secs', (SELECT COUNT(headway_secs) FROM gtfs_frequencies)),
('frequencies', 'exact_times', (SELECT COUNT(exact_times) FROM gtfs_frequencies)),
('transfers', 'from_stop_id', (SELECT COUNT(from_stop_id) FROM gtfs_transfers)),
('transfers', 'to_stop_id', (SELECT COUNT(to_stop_id) FROM gtfs_transfers)),
('transfers', 'transfer_type', (SELECT COUNT(transfer_type) FROM gtfs_transfers)),
('transfers', 'min_transfer_time', (SELECT COUNT(min_transfer_time) FROM gtfs_transfers)),
('feed_info', 'feed_publisher_name', (SELECT COUNT(feed_publisher_name) FROM gtfs_feed_info)),
('feed_info', 'feed_publisher_url', (SELECT COUNT(feed_publisher_url) FROM gtfs_feed_info)),
('feed_info', 'feed_lang', (SELECT COUNT(feed_lang) FROM gtfs_feed_info)),
('feed_info', 'feed_start_date', (SELECT COUNT(feed_start_date) FROM gtfs_feed_info)),
('feed_info', 'feed_end_date', (SELECT COUNT(feed_end_date) FROM gtfs_feed_info)),
('feed_info', 'feed_version', (SELECT COUNT(feed_version) FROM gtfs_feed_info))

;

